<!doctype html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>Stars test</title>
    <style>
    .box{
        border: 1px solid #000;
        padding: 5px;
    }
    .box .box{
        margin-left: 10px;
    }
    .line{
        padding: 10px 0;
    }
    .tip{
        position: fixed;
        top: 10px;
        left:500px;
        color: red;
    }
    input[type="text"]{
        width: 200px;
        line-height: 24px;
        border: 1px solid #666;
    }
    .error{
        border-color: red!important;
    }
    </style>
</head>
<body>
    <div class="tip"></div>
    <div class="test-form" data-Stars-type="form">
        <div class="box">
            <div class="line">
                <input type="radio" name="country" id="isNotCountry" checked/>不选择国家
                <input type="radio" name="country" id="isCountry"/>选择国家
            </div>

            <div class="box">
                <div class="line">
                    国家名称：<input type="text" id="countryName" placeholder="国家名称"/><span id="countryNameTip"></span>
                    国家代号：<input type="text" id="countryCode" placeholder="国家代号"/>
                </div>
                <div class="line">
                    <input type="checkbox" id="isProvince"/>所在省份信息
                </div>

                <div class="box">
                    <div class="line">
                        省份名称：<input type="text" id="provinceName" placeholder="省份"/>
                    </div>
                    <div class="line">
                        <input type="checkbox" id="isCity"/>所在城市信息
                    </div>

                    <div class="box">
                        <div class="line">
                            城市名称：<input type="text" id="cityName" placeholder="城市">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <button id="btn">提交</button>
    </div>
</body>
</html>

<script src="jquery.js"></script>
<script src="Stars.js"></script>

<script>

with (Stars){
    css.controlError = 'error'
    var formControl = control('.test-form').add(
        or(
            control('#isNotCountry').add(required()),
            and(
                control('#isCountry').add(required()),
                and(
                    control('#countryName').add(required('请填写国家名称')).setTipEle('#countryNameTip'),
                    control('#countryCode').add(
                        or(
                            rule(/^[a-z]{3,5}$/, '请填写3-5位的由小写字母组成的国家code,或者填写javascript'),
                            rule(function (control){
                                return control.val() == 'javascript'
                            }, '请填写3-5位的由小写字母组成的国家code,或者填写javascript')
                        )
                    ),
                    or(
                        control('#isProvince').add(not(required())),
                        and(
                            control('#isProvince').add(required()),
                            and(
                                control('#provinceName').add(required('请填写省份名称')),
                                or(
                                    control('#isCity').add(not(required())),
                                    and(
                                        control('#isCity').add(required()),
                                        control('#cityName').add(required('请填写城市名称'))
                                    )
                                )
                            )
                        )
                    )
                )
            )
        ).setTipEle('.tip')
    )

    $('#btn').on('click', function (){
        if (formControl.check()){
            alert('验证成功')
        }
    })
}
</script>